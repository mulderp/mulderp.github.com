
<!doctype html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> 	
<html lang="en"> 
<!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />	<!-- Force Latest IE rendering engine -->
    <title>DOM feedback with JavaScript Jasmine</title>

    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->


    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href="http://feeds.feedburner.com/ThinkingOnThinking" rel="alternate" title="mulderp" type="application/atom+xml" /> 
    <link rel="shortcut icon" href="/static/images/favicon.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 

    <link rel="stylesheet" href="/static/css/style.css">

    <!--[if IE 7]>
      <script src="/static/css/font-awesome-ie7.css"></script>
    <![endif]-->
    <script tyoe="text/javascript" src="/static/js/jquery-1.6.1.min.js"></script>
  </head>
  <body>
    <div class="container">	
      <div id='mobile' class='two columns hidden'>
        <ul>
          <li><span class="gray">Patrick Mulder</span></li>
          <li><a id="mail-to-mobile" href="mailto:mulder.patrick@gmail.com" onClick="">mulder.patrick@gmail.com</a></li>
          <li><a href="http://twitter.com/mulpat" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Mobile', Sidebar Email']);">@mulpat</a></li>
        </ul>
      </div>

      <div class="four columns sidebar">
        <section>
          <a id="" style="font-size: 16px; margin-bottom: 8px; padding-bottom: 8px; font-weight: bold" href="/">thinking_on thinking @main</a>

          <ul id="social">
            <li>
              <a href="mailto:mulder.patrick@gmail.com?subject=hi" class="icon-envelope-alt" id="mail-to"></a>
            </li>

            <li>
              <a href="http://twitter.com/mulpat" class="icon-twitter" id="twitter" style="font-size: 28px;"></a>
            </li>

            <li>
              <a href="http://github.com/mulderp" class="icon-github" id="github" title="I share and fork code here"></a>
            </li>

            <li>
              <a href="skype:patrickmulder__?add" class="icon-comment" id="skype" title="Feel free to add me on Skype"></a>
            </li>

            <li>
              <a href="http://feeds.feedburner.com/ThinkingOnThinking" class="icon-rss" id="rss" title="RSS"></a>
            </li>
          </ul>

          <ul id="me">
            <li>Patrick Mulder</span></li>
            <li class="gray">I like Ruby. JavaScript. Vim. Chef. NoSQL</li>
          </ul>
  
  <ul>
          <li>Get notified.</li>
          <li><form style="font-size: 8px;" action="http://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=ThinkingOnThinking', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true"><p>Enter your email address:</p><p><input type="text" style="width:140px" name="email"/></p><input type="hidden" value="ThinkingOnThinking" name="uri"/><input type="hidden" name="loc" value="en_US"/><input type="submit" value="Subscribe" /><p>Delivered by <a href="http://feedburner.google.com" target="_blank">FeedBurner</a></p></form></li>
</ul>
        </section>
      </div>

      <article class='ten columns offset-by-four' id="article-content">
  <header class="ten columns" id="article-header">
    <h1>DOM feedback with JavaScript Jasmine</h1>
    <i class="icon-tags"></i>  <a href="/tags/frontend" title="View posts tagged with &quot;frontend&quot;"><u>frontend</u></a>     <a href="/tags/JavaScript" title="View posts tagged with &quot;JavaScript&quot;"><u>JavaScript</u></a>     <a href="/tags/Jasmine" title="View posts tagged with &quot;Jasmine&quot;"><u>Jasmine</u></a>     <a href="/tags/TDD" title="View posts tagged with &quot;TDD&quot;"><u>TDD</u></a>     <a href="/tags/Specs" title="View posts tagged with &quot;Specs&quot;"><u>Specs</u></a>     <a href="/tags/DOM" title="View posts tagged with &quot;DOM&quot;"><u>DOM</u></a>   
  </header>

  <div class='ten columns gray' id="date-header">
    <p>
      Dec 2012
  
    </p>

  </div>

  <div class="ten columns" id="article-content">
    <p>In my first attempts to develop frontend interactions with Backbone.js, I discovered some blind spots in my understanding of Backbone views. Especially, I find the different options to organize views with parent and child-views, as well as attaching views to DOM nodes difficult. A nice overview on Backbone pitfalls is given <a href="http://blog.8thlight.com/cymen-vig/2012/12/13/reflections-on-using-backbone-js.html">here</a>.</p>

<p>As in many programming matters, thinking about outcomes and tests can help to write better code. This is where <a href="http://jasminejs.org/">Jasmine</a> can help in the development of Backbone applications.</p>

<p>First, there are several options to run Jasmine:</p>

<ul>
  <li>The most common option for running Jasmine specs is by having your default web browser loading a test DOM (from e.g. spec/index.html or spec/SpecRunner.html). Within this option you can declare a number of JavaScript dependencies that contain the actual specs, and that will be executed as soon as the Jasmine execution is triggered (with jasmine.getEnv().execute(); ).
Another option is to run Jasmine specs through rake. This option seems to be very popular in the Rails community; but as I am thinking more towards development of stand-alone frontend applications, I don’t want to have a tight Rails coupling. I could not get rake jasmine to render my specs from the Backbone setup; so, I will postpone this approach for a while. Maybe someone of you has made some more successful experiments?</li>
  <li>Another interesting attempt to get feedback from the DOM is to run Jasmine through a headless browser. PhantomJS comes naturally to mind in this context, and some interesting article is <a href="http://blog.jphpsf.com/2012/10/31/running-Jasmine-tests-with-Phantom-js-or-Webdriver/http://obtiva.com/blog/112-javascript-specs-with-jasmine-a-primer-for-rubyists-part-1">here</a>.</li>
</ul>

<p>As a first step to testing a Backbone application, I wanted to test some basic Backbone view properties. Now, one of the difficulties that I found was, how to actually load all dependencies into a browser with SpecRunner.html including RequireJS; and, execute some specs.</p>

<p>I found two approaches that work for me:</p>

<ol>
  <li>
    <h2 id="global-declaration-of-backbone-dependencies">Global declaration of backbone dependencies</h2>

    <script type="text/javascript" src="../public/js/libs/jquery/jquery.js">

</script>
  </li>
</ol>
<p>References to JQuery, Underscore and BackboneJS can be declared in a global way in the SpecRunner.html as follows:
* This should give access to the Backbone library where you need them. It works good enough, but maybe it’s useful to load your dependencies more in a dynamic way if your application grows. For this, the next option might be more interesting.</p>

<ol>
  <li>
    <h2 id="loading-backbone-dependencies-with-requirejs">Loading Backbone dependencies with RequireJS</h2>
  </li>
</ol>

<p>When using several dependencies (including custom views, collections, routers, etc.), requiring every module in the global scope of SpecRunner.html might result into increased editing efforts. Here is an attempt to re-use some module definitions with requirejs that could in principle be shared between your tests and the real application.</p>

<p>First, to load dependencies with requirejs, the following lines are needed in the specrunner.html</p>

<p>The first line refers to the jasmine-require project by Scott Burch that helps to require dependencies from within specs. Some example how this can be used with a JavaScript framework is shown here from the Pattern JS project.</p>

<p>With Backbone this might look like:</p>

<pre><code>  requireDependencies(["underscore", "backbone"], function(_, Backbone) {
    View = Backbone.View.extend({tagName: "li" });
    view = new View();
  });
</code></pre>

<ol>
  <li>
    <h2 id="other-approaches">Other approaches</h2>
  </li>
</ol>

<p>Another option to load dependencies with requirejs was described in <a href="https://groups.google.com/forum/?hl=en_US&amp;fromgroups=#!searchin/jasmine-js/requireJS/jasmine-js/7HJYbi705PE/XkpLR2DwQ0sJ">this discussion</a> in the Jasmine user group by using  testr.js However, I did not understand yet, how this is better than the previous option. (Maybe someone wants to comment?)</p>

<p>Last but not least, there is an interesting Jasmine setup with RequireJS here by Peter Toomberg’s Shortcut project. This one does not require any additional setup declarations, but I did not yet look into this too much.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Before actually running a succesful Jasmine spec for a Backbone view, we need a library to actually match DOM nodes with expected values. The common library for doing this are the Jasmine-JQuery matchers These allow to express many things, among if the .el property of a Backbone view actually match a DOM node as follows:</p>

<pre><code>View = Backbone.View.extend({tagName: "li" });
view = new View();


it("has el property", function() {
  expect(view.el).toBe("li");                                                                                                              
});
</code></pre>

<p>My current setup can be found here: <a href="https://github.com/mulderp/backbone-require-test/tree/view_specs">https://github.com/mulderp/backbone-require-test/tree/view_specs</a></p>

<p>Well, so far my findings. Maybe they are helpful for others. I would be curious to hear what you think? How you approach testing of DOM nodes.</p>

  </div>

  <footer class="ten columns">
    <p>
    <a class="btn btn-mini btn-info" href="https://github.com/mulderp/mulderp.github.com/issues/new" title="Leave feedback using GitHub" target="_blank"><i class="icon-comment icon-white"></i> Leave me feedback</a>
    </p>
    <p id='follow'>
      Follow me on Twitter <a href="http://twitter.com/mulpat" onClick="_gaq.push(['_trackEvent', 'Link', 'Click', 'Post Twitter']);">here.</a>
    </p>
    <p>
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="mulpat">Tweet</a>
       
      <!-- Put this just before the closing body tag -->
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </p>
    <p>
       <!-- Google + -->
       <p><g:plusone size="medium"></g:plusone></p>
        
       <!-- Add this just before the closing body tag of your web page -->	
       <script type="text/javascript">
         (function() {
           var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
           po.src = 'https://apis.google.com/js/plusone.js';
           var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
         })();
       </script>
    </p>
  </footer>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'thinkingonthinking'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
 
</article>
<script src="../static/js/disqus.js" type="text/javascript"></script>
<script type="text/javascript">
  var analytics=analytics||[];analytics.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);var r=function(e){return function(){analytics.push([e].concat(Array.prototype.slice.call(arguments,0)))}},i=["identify","track","trackLink","trackForm","trackClick","trackSubmit","pageview","ab","alias"];for(var s=0;s<i.length;s++)analytics[i[s]]=r(i[s])};
  analytics.load("t2dez1p4gw");
  analytics.track('Post', {
      title: "DOM feedback with JavaScript Jasmine"
    });
</script>

    </div>

<script type="text/javascript">
  var analytics=analytics||[];analytics.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);var r=function(e){return function(){analytics.push([e].concat(Array.prototype.slice.call(arguments,0)))}},i=["identify","track","trackLink","trackForm","trackClick","trackSubmit","pageview","ab","alias"];for(var s=0;s<i.length;s++)analytics[i[s]]=r(i[s])};
  analytics.load("t2dez1p4gw");
  $(document).ready(function() {
    analytics.trackLink( $("#mail-to"), 'mail_event', {source:"main"});
    analytics.trackLink( $("#github"), 'contact-github', {source:"main"});
    analytics.trackLink( $("#skype"), 'contact-skype', {source:"main"});
    analytics.trackLink( $("#rss"), 'contact-rss', {source:"main"});
  });
</script>
  </body>
</html> 
